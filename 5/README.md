# Отчет о выполнении лабораторной работы №5
## Распределение вычислительной нагрузки
### Задание
Модифицировать программы, составленные в Л.Р. №№3,4, распределив вычислительную нагрузку по секциям
(как минимум двумя способами). Измерять время работы программы для тех же значений параметров, что были использованы при выполнении Л.Р. №3. 

#### Выполнение:
Для реализации необходимого количества *секций*, я разбил основную часть работы, поиск максимумов в цикле, на несколько частей - 2, 4 и 8. Работа каждой части (*секции*) не зависит от
других частей, поэтому может выполняться паралелльно с другими. Также, *секции* были добавлены в функцию инициализации массива.

[Код программы](https://github.com/sekibura/Open-MP/blob/master/5/5/Source.cpp)

#### Результат выполнения программы:

##### Окно:
![2020-11-18_15-11-34](https://user-images.githubusercontent.com/51335422/99529123-62975580-29b0-11eb-9586-0b9009a8fea0.png)

##### Разберем вывод:

Сначала мы видим доказательство того, что многопоточность настроена и функционирует:
```
Max threads= 12
I am ready 0 from 12
I am ready 11 from 12
I am ready 3 from 12
I am ready 8 from 12
I am ready 7 from 12
I am ready 6 from 12
I am ready 10 from 12
I am ready 9 from 12
I am ready 4 from 12
I am ready 5 from 12
I am ready 1 from 12
I am ready 2 from 12
```
------
Далее идет уведомление о окончании инициализации массива и потраченное время:
```
Work took 3.071027 seconds to init
Work took 2.988157 seconds to init (SECTIONS)
```
Видно, что инициализация массива с применением *sections* происходит быстрее.

------
Далее происходит вывод результатов работы функции обработки массивов, время и конечная сумма макимальных элементов. Вывод конечной суммы сделан для проверки правильности работы каждой из функций.
Это результат работы функции без использования OpenMP.
```
C = 727331752
Work took 0.466065 seconds
```
------
Это результат работы функции с  использованем OpenMP, редукцией. Видно, что он превосходит время работы без OpenMP.
```
C_MP = 727331752
Work took 0.084014 seconds MP reduction
```
------

В этом случае функция использует две *секции* на каждой итерации цикла.
```
C = 727331752
Work took 4.804010 seconds SECTIONS inside for loop
```
------

В данном случае массив разделен на две части, работа идет в две *секции*.
```
C = 727331752
Work took 0.949729 seconds  with 2 SECTIONS
```
------

В данном случае массив разделен на четыре части, работа идет в четыре *секции*.
```
C = 727331752
Work took 1.202942 seconds  with 4 SECTIONS
```
------

В данном случае массив разделен на восемь части, работа идет в восемь *секций*.
```
C = 727331752
Work took 1.348308 seconds  with 8 SECTIONS
```
------

#### Выводы
Исходя из полученных измерений, можно сделать вывод, что нашем случае использование *sections* является излишеством и расточительством ресурсов. Предположу, что данные задачи
слишком тривиальны для использования данной директивы. На создание потоков уходит слишком много времени в масштабах данной задачи. Каждое добавление *секций* прибавляет время к выполнению.
Однако, это не означает, что *секции* не нужны вовсе. Их стоит использовать в более трудоемких задачах, где  время затраченное на создание потока будет незначительно перед полученным усорением в результат использования многопоточности.


